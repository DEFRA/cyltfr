{% extends 'layout.html' %}

{% set pageTitle = "See flood risk on a map" %}

{% block header %}
{% endblock %}


{% block head %}
{{ super() }}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="{{ assetPath }}/css/ol.css" type="text/css">
<link rel="shortcut icon" sizes="16x16 32x32 48x48" href="/assets/images/favicon.ico" type="image/x-icon">
<link href="{{ assetPath }}/stylesheets/map-page.css" rel="stylesheet" />
{% endblock %}


{% block bodyStart %}
{% block skipLink %}
{% endblock %}
<style>
  html {
    overflow-x: hidden;
  }

  body {
    margin: 0;
    height: 100vh;
    position: absolute;
    overflow-x: hidden;
  }

  .higher {
    top: calc(100vh - 177px);
  }

  .lower {
    top: calc(100vh - 110px);
  }
</style>
{{ super() }}
{% endblock %}

{% block main %}
<div class="map-container">
  <div class="defra-map-controls">

    <!-- Exit button -->
    <button class="defra-map__exit" id="exit-map" tabindex="1" onclick="window.location='{{ backLink }}'">
      <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 20 20">
        <path d="M4.828,11L12.314,18.485L10.899,19.899L1,10L10.899,0.101L12.314,1.515L4.828,9L19,9L19,11L4.828,11Z"
          style="fill:currentColor;stroke:currentColor;stroke-width:0.1px"></path>
      </svg>
      <span id="exit-text">Exit map</span>
    </button>

    <!-- Advanced options button -->
    <button class="defra-map__advanced" id="advanced-key-button" tabindex="1" style="color:	#0b0c0c;">
      <svg viewBox="0 0 24 24" height="24" width="24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
        <path id="advanced-button-image"
          d="m3.485 15.126-.971 1.748 9 5a1 1 0 0 0 .971 0l9-5-.971-1.748L12 19.856ZM20 8V6h2V4h-2V2h-2v2h-2v2h2v2zM2.513 12.833l9.022 5.04a.995.995 0 0 0 .973.001l8.978-5a1 1 0 0 0-.002-1.749l-9.022-5a1 1 0 0 0-.968-.001l-8.978 4.96a1 1 0 0 0-.003 1.749z">
        </path>
      </svg>
      <span id="advanced-button-text">Show advanced options</span>
    </button>

    <!-- map controls bottom -->
    <div class="defra-map-controls-bottom">

      <!-- open map on mobile -->
      <button class="button-content" id="open-key-button" onclick="openKey()">
        <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 20 20">
          <path d="M17.215,11.31L19,12.5L10,18.5L1,12.5L2.785,11.31L9.945,16.083C9.978,16.106 10.022,16.106 10.055,16.083L17.215,11.31Z"
          style="fill:currentColor;"></path>
          <path d="M10,1.5L1,7.5L10,13.5L19,7.5L10,1.5ZM10,3.88L15.43,7.5L10,11.12L4.57,7.5L10,3.88Z"
          style="fill:currentColor;"></path>
        </svg>
        <span class="govuk-visually-hidden">open</span><span class="open-button-text">Key</span>
      </button>

      <!-- Copyright -->
      <button class="defra-map-attribution" id="att-key-copyright-btn" tabindex="0" aria-controls="viewport"
        onclick="toggleCopyrightInfo()">
        <div class="button-content">
          <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 20 20">
            <path
              d="M10,2.5C11.286,2.5 12.52,2.823 13.701,3.469C14.883,4.116 15.811,5.038 16.487,6.235C17.162,7.433 17.5,8.688 17.5,10C17.5,11.305 17.169,12.551 16.506,13.735C15.844,14.92 14.92,15.844 13.735,16.506C12.551,17.169 11.305,17.5 10,17.5C8.695,17.5 7.449,17.169 6.265,16.506C5.08,15.844 4.156,14.92 3.494,13.735C2.831,12.551 2.5,11.305 2.5,10C2.5,8.688 2.838,7.433 3.513,6.235C4.189,5.038 5.117,4.116 6.299,3.469C7.48,2.823 8.714,2.5 10,2.5ZM10,3.978C8.969,3.978 7.978,4.236 7.028,4.752C6.079,5.268 5.333,6.007 4.791,6.97C4.249,7.932 3.978,8.943 3.978,10C3.978,11.044 4.244,12.043 4.776,12.996C5.308,13.949 6.051,14.692 7.004,15.224C7.957,15.756 8.956,16.022 10,16.022C11.044,16.022 12.043,15.756 12.996,15.224C13.949,14.692 14.692,13.949 15.224,12.996C15.756,12.043 16.022,11.044 16.022,10C16.022,8.949 15.751,7.941 15.209,6.975C14.667,6.008 13.921,5.268 12.972,4.752C12.022,4.236 11.031,3.978 10,3.978ZM11.821,11.116L13.398,11.645C13.149,12.467 12.738,13.097 12.164,13.535C11.589,13.972 10.904,14.191 10.108,14.191C8.992,14.191 8.081,13.825 7.376,13.094C6.671,12.363 6.319,11.354 6.319,10.069C6.319,9.227 6.475,8.476 6.789,7.817C7.102,7.157 7.554,6.664 8.145,6.338C8.735,6.012 9.396,5.849 10.127,5.849C10.93,5.849 11.601,6.039 12.139,6.421C12.678,6.803 13.097,7.405 13.398,8.228L11.811,8.6C11.629,8.123 11.392,7.777 11.102,7.562C10.811,7.347 10.467,7.239 10.069,7.239C9.475,7.239 8.988,7.462 8.61,7.91C8.231,8.357 8.042,9.057 8.042,10.01C8.042,10.963 8.228,11.664 8.6,12.115C8.972,12.565 9.419,12.79 9.941,12.79C10.379,12.79 10.757,12.662 11.077,12.404C11.397,12.146 11.645,11.717 11.821,11.116Z"
              style="fill:currentColor;"></path>
          </svg>
          <span class="govuk-visually-hidden" id="copyright-hidden-text">copyright information</span>
        </div>
      </button>

      <div class="defra-map-info__container" id="copyright-info-container" style="display: none;">
        <div id="infoContent" class="defra-map-info__content">
          <div id="infoDescription">
            <div class="govuk-!-padding-2">
              <ul class="govuk-list">
                <li class="govuk-!-font-size-14"><a class="govuk-link"
                    href="https://check-long-term-flood-risk.service.gov.uk/os-terms" previewlistener="true">Contains OS
                    data</a><br>Â© Crown copyright and database rights {{year}}</li>
              </ul>
            </div>
          </div>
        </div>

        <button class="defra-map-info__close" onclick="toggleCopyrightInfo()">
          <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 20 20">
            <path d="M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z"
              style="fill:currentColor;stroke:currentColor;stroke-width:0.1px;"></path>
          </svg>
          <span class="govuk-visually-hidden">Close</span>
        </button>
      </div>

      <!-- Surface Water Depth scenarios -->
      <div class="defra-map-scenarios horizontal-overflow scenario-float-right v6-width-fix"
        id="scenario-container-depth">
        <div class="defra-map-scenarios-v3_container" id="scenarios-controls-depth">
          <div class="govuk-radios govuk-radios--small" id="scenario-selection-depth" data-module="govuk-radios">

            <div class="govuk-radios__item" style="border-bottom: 7px solid rgb(29, 112, 184);">
              <input class="govuk-radios__input" id="risk-radio-high-depth" onchange="scenarioDisplayUpdate('depth')"
                name="scenarios-depth" type="radio" value="{{maps.categories[4].maps[1].ref}}" checked="">
              <label class="govuk-label govuk-radios__label" for="risk-radio-high-depth">
                <strong class="scenario-heading">Up to 20cm</strong>
                <span class="risk-context-v3">(8in)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-medium-depth" onchange="scenarioDisplayUpdate('depth')"
                name="scenarios-depth" type="radio" value="{{maps.categories[4].maps[2].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-medium-depth">
                <strong class="scenario-heading"
                  style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 30cm</strong>
                <span class="risk-context-v3">(1ft)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-low-depth" onchange="scenarioDisplayUpdate('depth')"
                name="scenarios-depth" type="radio" value="{{maps.categories[4].maps[3].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-low-depth">
                <strong class="scenario-heading" style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 60cm</strong>
                <span class="risk-context-v3">(2ft)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-low-depth" onchange="scenarioDisplayUpdate('depth')"
                name="scenarios-depth" type="radio" value="{{maps.categories[4].maps[4].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-low-depth">
                <strong class="scenario-heading" style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 90cm</strong>
                <span class="risk-context-v3">(3ft)</span>
              </label>
            </div>            
          </div>
        </div>
      </div>

      <!-- Rivers and Sea Depth scenarios -->
      <div class="defra-map-scenarios horizontal-overflow scenario-float-right v6-width-fix"
        id="scenario-container-rs-depth">
        <div class="defra-map-scenarios-v3_container" id="scenarios-controls-rs-depth">
          <div class="govuk-radios govuk-radios--small" id="scenario-selection-rs-depth" style="display: none;" data-module="govuk-radios">

            <div class="govuk-radios__item" style="border-bottom: 7px solid rgb(29, 112, 184);">
              <input class="govuk-radios__input" id="risk-radio-high-rs-depth" onchange="scenarioDisplayUpdate('rsdepth')"
                name="scenarios-rs-depth" type="radio" value="{{maps.categories[3].maps[1].ref}}" checked="">
              <label class="govuk-label govuk-radios__label" for="risk-radio-high-rs-depth">
                <strong class="scenario-heading">Up to 20cm</strong>
                <span class="risk-context-v3">(8in)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-medium-rs-depth" onchange="scenarioDisplayUpdate('rsdepth')"
                name="scenarios-rs-depth" type="radio" value="{{maps.categories[3].maps[2].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-medium-rs-depth">
                <strong class="scenario-heading"
                  style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 30cm</strong>
                <span class="risk-context-v3">(1ft)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-low-rs-depth" onchange="scenarioDisplayUpdate('rsdepth')"
                name="scenarios-rs-depth" type="radio" value="{{maps.categories[3].maps[3].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-low-rs-depth">
                <strong class="scenario-heading" style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 60cm</strong>
                <span class="risk-context-v3">(2ft)</span>
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-very-low-rs-depth" onchange="scenarioDisplayUpdate('rsdepth')"
                name="scenarios-rs-depth" type="radio" value="{{maps.categories[3].maps[4].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-very-low-rs-depth">
                <strong class="scenario-heading" style="text-decoration: underline; text-decoration-thickness: 2px;">Up to 90cm</strong>
                <span class="risk-context-v3">(3ft)</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Velocity scenarios -->
      <div class="defra-map-scenarios horizontal-overflow scenario-float-right v6-width-fix"
        id="scenario-container-velocity">
        <div class="defra-map-scenarios-v3_container" id="scenarios-controls-velocity">
          <div class="govuk-radios govuk-radios--small" id="scenario-selection-velocity" data-module="govuk-radios">

            <div class="govuk-radios__item" style="border-bottom: 7px solid rgb(29, 112, 184);">
              <input class="govuk-radios__input" id="risk-radio-high-velocity"
                onchange="scenarioDisplayUpdate('velocity')" name="scenarios-velocity" type="radio"
                value="{{maps.categories[1].maps[2].ref}}" checked="">
              <label class="govuk-label govuk-radios__label" for="risk-radio-high-velocity">
                <strong class="scenario-heading">High risk</strong>
                <span class="risk-context-v3">3.3% chance each year</span>
              </label>
            </div>

            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-medium-velocity"
                onchange="scenarioDisplayUpdate('velocity')" name="scenarios-velocity" type="radio"
                value="{{maps.categories[1].maps[4].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-medium-velocity">
                <strong class="scenario-heading"
                  style="text-decoration: underline; text-decoration-thickness: 2px;">Medium risk</strong>
                <span class="risk-context-v3">1% chance each year</span>
              </label>
            </div>

            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="risk-radio-low-velocity"
                onchange="scenarioDisplayUpdate('velocity')" name="scenarios-velocity" type="radio"
                value="{{maps.categories[1].maps[6].ref}}">
              <label class="govuk-label govuk-radios__label" for="risk-radio-low-velocity">
                <strong class="scenario-heading" style="text-decoration: underline; text-decoration-thickness: 2px;">Low
                  risk</strong>
                <span class="risk-context-v3">0.1% chance each year</span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Key -->
  <div id="map-key" class="defra-map-key" style="display: block;">
    <div class="defra-map-key__container" id="defra-map-key__container">
      <h2 id="mapKeyLabel" class="defra-map-key__title">
        <span role="text">Key<span class="govuk-visually-hidden">for map features</span></span>
      </h2>
      <button class="defra-map-key__close" id="close-key" onclick="closeKey()">
        <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 20 20"><path d="M10,8.6L15.6,3L17,4.4L11.4,10L17,15.6L15.6,17L10,11.4L4.4,17L3,15.6L8.6,10L3,4.4L4.4,3L10,8.6Z" fill="" style="fill:currentColor;stroke:currentColor;stroke-width:0.1px;"></path>
        </svg>
        <span class="govuk-visually-hidden">Close key</span>
      </button>

      <div class="defra-map-key__content">
        <div class="govuk-form-group" id="map-key__section">
          <div id="sw-section-container">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" ontoken="this.onscrolling = false">Surface water: yearly chance of flooding</h3>
              </legend>

              <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input extent-radio" id="sw-extent-radio"
                    onchange="handleRadioChange('extent', 'surface water')" value="{{maps.categories[4].maps[0].ref}}"
                    title="Extent of flooding from surface water" name="measurements" type="radio" checked="">
                  <label class="govuk-label govuk-radios__label" for="sw-extent-radio">
                    <span class="surface-water-bulletpoint__heading" id="surface-water-extent__heading">Flood area (extent)</span>

                    <div id="sw-extent-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-extent-high">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#99004d"></rect>
                          </svg>
                        </span>
                        <span id="risk-severity">High chance</span>
                        <!-- <span class="risk-context">More than 3.3% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-extent-med">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#e6772e"></rect>
                          </svg>
                        </span>
                        Medium chance
                        <!-- <span class="risk-context">Between 3.3% and 1% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-extent-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#ffbfc9"></rect>
                          </svg>
                        </span>
                        Low chance
                        <!-- <span class="risk-context">Between 1% and 0.1% chance each year</span> -->
                      </span>

                      <!-- <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-extent-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#c4c0c0"></rect>
                          </svg>
                        </span>
                        Very low chance
                        <span class="risk-context">Less than 0.1% chance each year</span>
                      </span>                    -->
                    </div>
                  </label>
                </div>

                <!-- <div class="govuk-radios__item">
                  <input class="govuk-radios__input" id="sw-depth-radio" onchange="handleRadioChange('depth')"
                    value="{{maps.categories[4].maps[1].ref}}" name="measurements"
                    title="Surface water flood risk: water depth in a high risk scenario" type="radio">
                  <label class="govuk-label govuk-radios__label" for="sw-depth-radio">
                    <span class="surface-water-bulletpoint__heading" id="surface-water-depth__heading">Depth</span>

                    <div id="sw-depth-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="sw-depth-above-90">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#99004d"></rect>
                          </svg>
                        </span>
                        <span id="surfacewater-depth-above-90">High risk</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="w-depth-30-90">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#e6772e"></rect>
                          </svg>
                        </span>
                        <span id="surfacewater-depth-30-90">Medium risk</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="sw-depth-below-30">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#ffbfc9"></rect>
                          </svg>
                        </span>
                        <span class="surfacewater-depth-below-30">Low risk</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="sw-depth-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#c4c0c0"></rect>
                          </svg>
                        </span>
                        <span class="surfacewater-depth-below-30">Very low risk</span>
                      </span>

                    </div>
                  </label>
                </div> -->

                <div class="govuk-radios__item showing advanced-map-option" id="sw-velocity-section-container">
                  <input class="govuk-radios__input" id="sw-velocity-radio" onchange="handleRadioChange('velocity')"
                    value="{{maps.categories[1].maps[2].ref}}" name="measurements"
                    title="Surface water flood risk: water velocity in a high risk scenario" type="radio">
                  <label class="govuk-label govuk-radios__label" for="sw-velocity-radio">
                    <span class="surface-water-bulletpoint__heading" id="surface-water-velocity__heading">Velocity</span>

                    <div id="sw-velocity-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-velocity-container"
                        id="sw-velocity-more">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#555C9D"></rect>
                          </svg>
                        </span>
                        <span id="risk-severity">More than 0.25 m/s</span>
                        <span class="risk-context">Metres per second</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-velocity-container"
                        id="sw-velocity-less">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#C4E1FF"></rect>
                          </svg>
                        </span>
                        <span class="surfacewater-depth-below-30">Less than 0.25 m/s</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-velocity-container"
                        id="sw-velocity-arrow">
                        <img class="defra-map-key__symbol arrow-symbol" src="{{ assetPath }}/images/arrow.png">
                        Direction
                      </span>
                    </div>
                  </label>
                </div>

              </div>
            </fieldset>
          </div>

          <!-- Rivers and the sea -->
          <div class="key-item-container" id="rs-section-container">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" id="rs-title" ontoken="this.onscrolling = false">Rivers and the
                  sea: yearly chance of flooding</h3>
              </legend>

              <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input extent-radio" id="rs-radio"
                    onchange="handleRadioChange('extent', 'rivers and the sea')"
                    value="{{maps.categories[3].maps[0].ref}}" title="Extent of flooding from rivers and seas"
                    name="measurements" type="radio">
                  <label class="govuk-label govuk-radios__label" for="rs-radio">
                    <span class="bulletpoint__heading" id="rs-extent__heading">Flood Area (extent)</span>
                    <div class="extent-desc-container" id="rs-extent-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-extent-high">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#555C9D"></rect>
                          </svg>
                        </span>
                        <span id="risk-severity">High chance</span>
                        <!-- <span class="risk-context">More than 3.3% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-extent-med">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#9AA0DE"></rect>
                          </svg>
                        </span>
                        Medium chance
                        <!-- <span class="risk-context">Between 3.3% and 1% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-extent-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#C4E1FF"></rect>
                          </svg>
                        </span>
                        Low chance
                        <!-- <span class="risk-context">Between 1% and 0.1% chance each year</span> -->
                      </span>

                      <span class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                      id="rs-extent-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32"><rect x="5" y="5" width="22" height="22" style="fill:#c9f8ff"></rect></svg>
                        </span>
                        Very low chance
                        <!-- <span class="risk-context">Less than 0.1% chance each year</span> -->
                      </span>
                    </div>
                  </label>
                </div>

                <!-- <div class="govuk-radios__item">
                  <input class="govuk-radios__input" id="rs-depth-radio" onchange="handleRadioChange('rsdepth')"
                    value="{{maps.categories[3].maps[1].ref}}" name="measurements"
                    title="Rivers and seas flood risk: water depth in a high risk scenario" type="radio">
                  <label class="govuk-label govuk-radios__label" for="rs-depth-radio">
                    <span class="surface-water-bulletpoint__heading" id="surface-water-depth__heading">Depth</span>

                    <div id="rs-depth-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="rs-depth-above-90">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#555C9D"></rect>
                          </svg>
                        </span>
                        <span id="riversea-depth-above-90">High chance</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="rs-depth-30-90">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#9AA0DE"></rect>
                          </svg>
                        </span>
                        <span id="riversea-depth-30-90">Medium chance</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="rs-depth-below-30">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#C4E1FF"></rect>
                          </svg>
                        </span>
                        <span class="riversea-depth-below-30">Low chance</span>
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-depth-container"
                        id="rs-depth-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill: #c9f8ff"></rect>
                          </svg>
                        </span>
                        <span class="riversea-depth-below-30">Very low chance</span>
                      </span>
                    </div>
                  </label>
                </div> -->
              </div>
            </fieldset>
          </div>

          <!-- Rivers and the sea climate change extent -->
          <div class="key-item-container" id="rs-ccrs2-section-container">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" id="rs-title" ontoken="this.onscrolling = false">Yearly chance of flooding by the 2050s</h3>
              </legend>

              <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input extent-radio" id="rs-ccrs2-radio"
                    onchange="handleRadioChange('extent', 'rivers and the sea climate change')"
                    value="{{maps.categories[3].maps[5].ref}}" title="Extent of flooding from rivers and seas"
                    name="measurements" type="radio">
                  <label class="govuk-label govuk-radios__label" for="rs-ccrs2-radio">
                    <span class="bulletpoint__heading" id="rs-ccrs2-extent__heading">Flood area (extent)</span>
                    <div class="extent-desc-container" id="rs-ccrs2-extent-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-ccrs2-extent-high">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#555C9D"></rect>
                          </svg>
                        </span>
                        <span id="risk-severity">High chance</span>
                        <!-- <span class="risk-context">More than 3.3% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-ccrs2-extent-med">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#9AA0DE"></rect>
                          </svg>
                        </span>
                        Medium chance
                        <!-- <span class="risk-context">Between 3.3% and 1% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="rs-ccrs2-extent-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#C4E1FF"></rect>
                          </svg>
                        </span>
                        Low chance
                        <!-- <span class="risk-context">Between 1% and 0.1% chance each year</span> -->
                      </span>

                      <span class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                      id="rs-ccrs2-extent-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32"><rect x="5" y="5" width="22" height="22" style="fill:#c9f8ff"></rect></svg>
                        </span>
                        Very low chance
                        <!-- <span class="risk-context">Less than 0.1% chance each year</span> -->
                      </span>
                    </div>
                  </label>
                </div>
              </div>
            </fieldset>
          </div>

          <!-- Surface Water climate change extent -->

          <div class="key-item-container" id="sw-ccrs3-section-container">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" ontoken="this.onscrolling = false">Yearly chance of flooding by the 2050s</h3>
              </legend>

              <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input extent-radio" id="sw-ccrs3-extent-radio"
                    onchange="handleRadioChange('extent', 'surface water climate change')" value="{{maps.categories[4].maps[5].ref}}"
                    title="Extent of flooding from surface water" name="measurements" type="radio">
                  <label class="govuk-label govuk-radios__label" for="sw-ccrs3-extent-radio">
                    <span class="surface-water-bulletpoint__heading" id="surface-water-ccrs3-extent__heading">Flood area (extent)</span>

                    <div id="sw-ccrs3-extent-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-ccrs3-extent-high">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#99004d"></rect>
                          </svg>
                        </span>
                        <span id="risk-severity">High chance</span>
                        <!-- <span class="risk-context">More than 3.3% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-ccrs3-extent-med">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#e6772e"></rect>
                          </svg>
                        </span>
                        Medium chance
                        <!-- <span class="risk-context">Between 3.3% and 1% chance each year</span> -->
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-ccrs3-extent-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#ffbfc9"></rect>
                          </svg>
                        </span>
                        Low chance
                        <!-- <span class="risk-context">Between 1% and 0.1% chance each year</span> -->
                      </span>

                      <!-- <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi sw-extent-container"
                        id="sw-ccrs3-extent-very-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#c4c0c0"></rect>
                          </svg>
                        </span>
                        Very low chance
                        <span class="risk-context">Less than 0.1% chance each year</span>
                      </span>                    -->
                    </div>
                  </label>
                </div>
              </div>
            </fieldset>
          </div>    

          <!-- Reservoirs -->
          <div class="key-item-container" id="reservoirs-section-container">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" id="reservoir-title" ontoken="this.onscrolling = false">
                  Reservoirs</h3>
              </legend>

              <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input extent-radio" id="reservoirs-radio"
                    onchange="handleRadioChange('extent', 'reservoirs')" value="{{maps.categories[2].maps[0].ref}}"
                    title="Extent of flooding from reservoirs" name="measurements" type="radio">
                  <label class="govuk-label govuk-radios__label" for="reservoirs-radio">
                    <span class="bulletpoint__heading" id="reservoirs-extent__heading">Extent</span>
                    <div class="extent-desc-container" id="reservoirs-extent-desc-container">
                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="reservoirs-extent-med">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#9AA0DE"></rect>
                          </svg>
                        </span>
                        When river levels are normal
                      </span>

                      <span
                        class="defra-map-key__symbol-container-v3 defra-map-key__symbol-container--multi extent-container"
                        id="reservoirs-extent-low">
                        <span class="defra-map-key__symbol">
                          <svg aria-hidden="true" focusable="false" width="32" height="32" viewBox="0 0 32 32">
                            <rect x="5" y="5" width="22" height="22" style="fill:#C4E1FF"></rect>
                          </svg>
                        </span>
                        When there is also flooding from rivers
                      </span>
                    </div>
                  </label>
                </div>
              </div>
            </fieldset>
          </div>

          <!-- Toggle checkbox -->
          <div class="govuk-form-group">
            <fieldset class="govuk-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                <h3 class="defra-map-key__section-title" id="map-display-toggles-title">Map details</h3>
              </legend>
              <div class="govuk-radios govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
                <div class="govuk-checkboxes__item">
                  <input class="govuk-checkboxes__input" id="display-layers-checkbox" name="map-toggle" type="checkbox"
                    onchange="" value="30" checked="">
                  <label class="govuk-label  govuk-checkboxes__label" for="display-layers-checkbox">
                    Show flooding
                  </label>
                </div>
                <div class="govuk-checkboxes__item" id="selected-address">
                  <input class="govuk-checkboxes__input" id="selected-address-checkbox" name="map-toggle" type="checkbox" value=""
                    checked="">
                  <label class="govuk-label govuk-checkboxes__label" for="selected-address-checkbox">
                    <span class="defra-map-key__symbol-container">
                      <span class="defra-map-key__symbol">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#f54545" class="w-6 h-6">
                          <path fill-rule="evenodd"
                            d="M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z"
                            clip-rule="evenodd"></path>
                        </svg>
                      </span>
                      Selected address
                    </span>
                    <span class="defra-map-key__symbol-container defra-map-key__symbol-container--multi" id="boundary-container">
                      <span class="defra-map-key__symbol">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="#ede72e">
                          <circle cx="50" cy="50" r="40"></circle>
                        </svg>
                      </span>
                      15m boundary
                    </span>
                  </label>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="progress"></div>
  <div id="map"></div>
</div>
{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script src="{{ assetPath }}/js/vendor/ol.js"></script>
<script src="{{ assetPath }}/js/vendor/proj4-2.5.0.js"></script>
<script
  src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,Object.assign,Element.prototype.placeholder"></script>
<script src="{{ assetPath }}/nunjucks-slim.js"></script>
<script src="{{ assetPath }}/js/map.js"></script>
<script src="{{ assetPath }}/js/templates.js"></script>
<script>
  window.mapCategories = {{ maps | dump | safe }}
</script>
<script src="{{ assetPath }}/js/map-page.js"></script>
{% endblock %}

{% block footer %}
{% endblock %}